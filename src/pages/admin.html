<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - Java Tutor</title>
    <link rel="stylesheet" href="../css/admin.css">
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i data-feather="shield"></i>
                    <span class="logo-text">Admin Panel</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="#exercises" class="nav-item active" data-section="exercises" data-tooltip="Ejercicios">
                    <i data-feather="code"></i>
                    <span class="nav-text">Ejercicios</span>
                </a>
                <a href="#analytics" class="nav-item" data-section="analytics" data-tooltip="Analíticas">
                    <i data-feather="bar-chart-2"></i>
                    <span class="nav-text">Analíticas</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <a href="dashboard.html" class="nav-item" data-tooltip="Volver al Dashboard">
                    <i data-feather="arrow-left"></i>
                    <span class="nav-text">Volver al Dashboard</span>
                </a>
                <div class="admin-profile" id="adminProfile">
                    <img src="" alt="Admin" class="admin-avatar">
                    <div class="admin-info">
                        <div class="admin-name" id="adminName">Cargando...</div>
                        <div class="admin-role">Administrador</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Mobile Sidebar Toggle -->
        <button class="mobile-sidebar-toggle" id="mobileSidebarToggle">
            <i data-feather="menu"></i>
        </button>

        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="admin-header">
                <div class="header-left">
                    <h1 class="page-title" id="pageTitle">Gestión de Ejercicios</h1>
                    <p class="page-subtitle" id="pageSubtitle">Crea y administra ejercicios de Java</p>
                </div>
                <div class="header-right">
                    <button class="btn btn-primary" id="createExerciseBtn">
                        <i data-feather="plus"></i>
                        Nuevo Ejercicio
                    </button>
                </div>
            </header>

            <!-- Exercises Section -->
            <section class="content-section active" id="exercises-section">
                <!-- Search and Filters Bar -->
                <div class="admin-filters-bar">
                    <div class="search-box">
                        <i data-feather="search"></i>
                        <input type="text" id="adminSearchInput" placeholder="Buscar por título, autor o categoría...">
                    </div>
                    
                    <div class="filter-group">
                        <label for="authorFilter">
                            <i data-feather="user"></i>
                            Autor
                        </label>
                        <select id="authorFilter" class="filter-select">
                            <option value="all">Todos los autores</option>
                        </select>
                    </div>
                    
                    <div class="view-toggle">
                        <button class="view-btn active" id="adminGridViewBtn" data-view="grid" title="Vista de tarjetas">
                            <i data-feather="grid"></i>
                        </button>
                        <button class="view-btn" id="adminListViewBtn" data-view="list" title="Vista de lista">
                            <i data-feather="list"></i>
                        </button>
                    </div>
                </div>
                
                <div class="exercises-grid" id="exercisesGrid">
                    <!-- Loading skeleton -->
                    <div class="skeleton-card"></div>
                    <div class="skeleton-card"></div>
                    <div class="skeleton-card"></div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section class="content-section" id="analytics-section">
                <h2>Analíticas del Sistema</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">Usuarios Totales</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="code"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalExercises">0</div>
                            <div class="stat-label">Ejercicios Creados</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="send"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalSubmissions">0</div>
                            <div class="stat-label">Envíos Totales</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="successRate">0%</div>
                            <div class="stat-label">Tasa de Éxito</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal: Create/Edit Exercise -->
    <div class="modal" id="exerciseModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="modalTitle">Crear Nuevo Ejercicio</h2>
                <button class="modal-close" id="closeExerciseModal">
                    <i data-feather="x"></i>
                </button>
            </div>

            <div class="modal-body">
                <form id="exerciseForm">
                    <!-- Basic Info -->
                    <div class="form-section">
                        <h3>Información Básica</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="exerciseTitle">Título del Ejercicio *</label>
                                <input type="text" id="exerciseTitle" required placeholder="Ej: Suma de dos números">
                            </div>
                            <div class="form-group">
                                <label for="exerciseCategory">Categoría *</label>
                                <select id="exerciseCategory" required>
                                    <option value="">Selecciona una categoría</option>
                                    <option value="basicos">Básicos</option>
                                    <option value="condicionales">Condicionales</option>
                                    <option value="ciclos">Ciclos</option>
                                    <option value="arreglos">Arreglos</option>
                                    <option value="poo">POO</option>
                                    <option value="avanzados">Avanzados</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="exerciseDifficulty">Dificultad *</label>
                                <select id="exerciseDifficulty" required>
                                    <option value="">Selecciona dificultad</option>
                                    <option value="easy">Fácil</option>
                                    <option value="medium">Medio</option>
                                    <option value="hard">Difícil</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="exercisePoints">Puntos *</label>
                                <input type="number" id="exercisePoints" required min="1" placeholder="10">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="exerciseDescription">Descripción *</label>
                            <textarea id="exerciseDescription" required rows="4" 
                                placeholder="Describe el ejercicio, los requisitos y lo que se espera..."></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="exerciseAuthor">Nombre del Autor *</label>
                                <input type="text" id="exerciseAuthor" required placeholder="Ej: Juan Pérez">
                            </div>
                            <div class="form-group">
                                <label for="exerciseTheoryLink">Enlace de Teoría</label>
                                <input type="url" id="exerciseTheoryLink" placeholder="https://ejemplo.com/teoria">
                            </div>
                        </div>
                    </div>

                    <!-- Template Code -->
                    <div class="form-section">
                        <h3>Código Base (Template)</h3>
                        <div class="form-group">
                            <label for="exerciseTemplate">Plantilla de Código *</label>
                            <textarea id="exerciseTemplate" required rows="10" 
                                placeholder="{&#10; public class Main {&#10;  public static void main(String[] args) {&#10;    // Tu código aquí&#10;  }&#10;}"></textarea>
                        </div>
                    </div>

                    <!-- Test Code -->
                    <div class="form-section">
                        <h3>Código de Test (AppTest.java)</h3>
                        <div class="form-group">
                            <label for="exerciseTestCode">Código Completo del Test *</label>
                            <p class="help-text">Pega aquí el código completo de AppTest.java que validará las soluciones de los estudiantes.</p>
                            <textarea id="exerciseTestCode" required rows="20" 
                                placeholder="package com.javatutor;&#10;&#10;import org.junit.jupiter.api.Test;&#10;import static org.junit.jupiter.api.Assertions.*;&#10;&#10;class AppTest {&#10;    @Test&#10;    void testSolution() {&#10;        // Tu test aquí&#10;    }&#10;}"></textarea>
                        </div>
                    </div>

                    <!-- Solution Code (Admin Only) -->
                    <div class="form-section solution-section">
                        <h3>
                            <i data-feather="lock"></i>
                            Código de Solución (Solo Admins)
                        </h3>
                        <div class="form-group">
                            <label for="exerciseSolutionCode">Código Completo de Solución (App.java) *</label>
                            <p class="help-text">
                                <i data-feather="info"></i>
                                Este es el código que pasa todos los tests. Solo visible para administradores.
                            </p>
                            <textarea id="exerciseSolutionCode" required rows="20" 
                                placeholder="package com.javatutor;&#10;&#10;public class App {&#10;    public static void main(String[] args) {&#10;        // Solución completa aquí&#10;    }&#10;}"></textarea>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelExerciseBtn">Cancelar</button>
                        <button type="submit" class="btn btn-primary" id="saveExerciseBtn">
                            <i data-feather="save"></i>
                            Guardar Ejercicio
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>feather.replace();</script>
    <script type="module" src="../js/admin.js"></script>
</body>
</html>
